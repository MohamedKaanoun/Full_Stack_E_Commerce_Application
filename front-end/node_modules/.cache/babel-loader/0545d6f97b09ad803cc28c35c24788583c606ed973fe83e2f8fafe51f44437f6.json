{"ast":null,"code":"import axios from \"axios\";\nimport { API_BASE_URL } from \"../../config/ApiConfig\";\nimport { GET_USER_FAILURE, GET_USER_REQUEST, GET_USER_SUCCESS, LOGIN_FAILURE, LOGIN_REQUEST, LOGIN_SUCCESS, LOGOUT, REGISTER_FAILURE, REGISTER_REQUEST, REGISTER_SUCCESS } from \"./ActionType\";\nimport { useNavigate } from \"react-router-dom\";\nconst registerRequest = () => ({\n  type: REGISTER_REQUEST\n});\nconst registerSuccess = user => ({\n  type: REGISTER_SUCCESS,\n  payload: user\n});\nconst registerFailure = error => ({\n  type: REGISTER_FAILURE,\n  payload: error\n});\nexport const register = userData => {\n  var _s = $RefreshSig$();\n  return _s(async dispatch => {\n    _s();\n    const navigate = useNavigate();\n    dispatch(registerRequest());\n    try {\n      const response = await axios.post(API_BASE_URL + \"auth/register\", userData);\n      const user = response.data;\n      dispatch(registerSuccess(user));\n      navigate(\"/login\"); // Navigate to the login page after successful registration\n    } catch (error) {\n      dispatch(registerFailure(error.message));\n    }\n  }, \"CzcTeTziyjMsSrAVmHuCCb6+Bfg=\", false, function () {\n    return [useNavigate];\n  });\n};\nconst loginRequest = () => ({\n  type: LOGIN_REQUEST\n});\nconst loginSuccess = user => ({\n  type: LOGIN_SUCCESS,\n  payload: user\n});\nconst loginFailure = error => ({\n  type: LOGIN_FAILURE,\n  payload: error\n});\nexport const login = userData => async dispatch => {\n  dispatch(loginRequest());\n  try {\n    const response = await axios.post(API_BASE_URL + \"auth/authenticate\", userData);\n    const jwt = response.data.token; // Assuming the response contains a 'token' field\n    if (!jwt) {\n      throw new Error(\"JWT token not found in response\");\n    }\n    localStorage.setItem(\"jwt\", jwt);\n    const userResponse = await axios.get(API_BASE_URL + \"users/profile\", {\n      headers: {\n        Authorization: `Bearer ${jwt}`\n      }\n    });\n    const user = userResponse.data;\n    console.log(user);\n    dispatch(loginSuccess(user));\n    return {\n      payload: user\n    };\n  } catch (error) {\n    dispatch(loginFailure(error.message));\n    return {\n      error: error.message\n    };\n  }\n};\nconst getUserRequest = () => ({\n  type: GET_USER_REQUEST\n});\nconst getUserSuccess = user => ({\n  type: GET_USER_SUCCESS,\n  payload: user\n});\nconst getUserFailure = error => ({\n  type: GET_USER_FAILURE,\n  payload: error\n});\nexport const getUser = jwt => async dispatch => {\n  dispatch(getUserRequest());\n  try {\n    const response = await axios.get(API_BASE_URL + \"users/profile\", {\n      headers: {\n        Authorization: `Bearer ${jwt}`\n      }\n    });\n    const user = response.data;\n    dispatch(getUserSuccess(user));\n  } catch (error) {\n    dispatch(getUserFailure(error.message));\n  }\n};\nexport const logout = () => dispatch => {\n  dispatch({\n    type: LOGOUT,\n    payload: null\n  });\n  localStorage.clear();\n};","map":{"version":3,"names":["axios","API_BASE_URL","GET_USER_FAILURE","GET_USER_REQUEST","GET_USER_SUCCESS","LOGIN_FAILURE","LOGIN_REQUEST","LOGIN_SUCCESS","LOGOUT","REGISTER_FAILURE","REGISTER_REQUEST","REGISTER_SUCCESS","useNavigate","registerRequest","type","registerSuccess","user","payload","registerFailure","error","register","userData","_s","$RefreshSig$","dispatch","navigate","response","post","data","message","loginRequest","loginSuccess","loginFailure","login","jwt","token","Error","localStorage","setItem","userResponse","get","headers","Authorization","console","log","getUserRequest","getUserSuccess","getUserFailure","getUser","logout","clear"],"sources":["C:/Users/Mohamed Kaanoun/Documents/WEB/E-commerce/front-end/src/State/Auth/Action.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { API_BASE_URL } from \"../../config/ApiConfig\";\r\nimport {\r\n  GET_USER_FAILURE,\r\n  GET_USER_REQUEST,\r\n  GET_USER_SUCCESS,\r\n  LOGIN_FAILURE,\r\n  LOGIN_REQUEST,\r\n  LOGIN_SUCCESS,\r\n  LOGOUT,\r\n  REGISTER_FAILURE,\r\n  REGISTER_REQUEST,\r\n  REGISTER_SUCCESS,\r\n} from \"./ActionType\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst registerRequest = () => ({ type: REGISTER_REQUEST });\r\nconst registerSuccess = (user) => ({ type: REGISTER_SUCCESS, payload: user });\r\nconst registerFailure = (error) => ({ type: REGISTER_FAILURE, payload: error });\r\n\r\nexport const register = (userData) => async (dispatch) => {\r\n  const navigate = useNavigate();\r\n  dispatch(registerRequest());\r\n  try {\r\n    const response = await axios.post(API_BASE_URL + \"auth/register\", userData);\r\n    const user = response.data;\r\n    dispatch(registerSuccess(user));\r\n    navigate(\"/login\"); // Navigate to the login page after successful registration\r\n  } catch (error) {\r\n    dispatch(registerFailure(error.message));\r\n  }\r\n};\r\n\r\nconst loginRequest = () => ({ type: LOGIN_REQUEST });\r\nconst loginSuccess = (user) => ({ type: LOGIN_SUCCESS, payload: user });\r\nconst loginFailure = (error) => ({ type: LOGIN_FAILURE, payload: error });\r\n\r\nexport const login = (userData) => async (dispatch) => {\r\n  dispatch(loginRequest());\r\n  try {\r\n    const response = await axios.post(\r\n      API_BASE_URL + \"auth/authenticate\",\r\n      userData\r\n    );\r\n    const jwt = response.data.token; // Assuming the response contains a 'token' field\r\n    if (!jwt) {\r\n      throw new Error(\"JWT token not found in response\");\r\n    }\r\n    localStorage.setItem(\"jwt\", jwt);\r\n    const userResponse = await axios.get(API_BASE_URL + \"users/profile\", {\r\n      headers: {\r\n        Authorization: `Bearer ${jwt}`,\r\n      },\r\n    });\r\n    const user = userResponse.data;\r\n    console.log(user);\r\n    dispatch(loginSuccess(user));\r\n    return { payload: user };\r\n  } catch (error) {\r\n    dispatch(loginFailure(error.message));\r\n    return { error: error.message };\r\n  }\r\n};\r\n\r\nconst getUserRequest = () => ({ type: GET_USER_REQUEST });\r\nconst getUserSuccess = (user) => ({ type: GET_USER_SUCCESS, payload: user });\r\nconst getUserFailure = (error) => ({ type: GET_USER_FAILURE, payload: error });\r\n\r\nexport const getUser = (jwt) => async (dispatch) => {\r\n  dispatch(getUserRequest());\r\n  try {\r\n    const response = await axios.get(API_BASE_URL + \"users/profile\", {\r\n      headers: {\r\n        Authorization: `Bearer ${jwt}`,\r\n      },\r\n    });\r\n    const user = response.data;\r\n    dispatch(getUserSuccess(user));\r\n  } catch (error) {\r\n    dispatch(getUserFailure(error.message));\r\n  }\r\n};\r\n\r\nexport const logout = () => (dispatch) => {\r\n  dispatch({ type: LOGOUT, payload: null });\r\n  localStorage.clear();\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}